<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>All of 1 ‚Äî Demo</title>
<link rel="icon" href="" />
<link rel="websiteicon" href="1832638.png">
<style>
  :root{
    --bg1: #6A529F;
    --bg2: #261949;
    --card: #191d2e;
    --muted: #93a1bd;
    --accent: #3fa7ff;
    --glass: rgba(25,29,46,0.6);
    --radius: 14px;
  }
  *{box-sizing:border-box;margin:0;padding:0;font-family:Inter, "Segoe UI", system-ui, Arial;}
  body{
    min-height:100vh;
    background: linear-gradient(135deg,var(--bg1) 0%, #563977 65%, var(--bg2) 100%);
    color:#e9e3ff;
    padding-bottom:92px; /* for bottom bar */
  }

  /* Container */
  .app {
    max-width:1100px;
    margin:28px auto;
    display:grid;
    grid-template-columns: 1fr 360px;
    gap:20px;
    padding:18px;
  }

  /* Left column: feed + chat toggle */
  .main {
    display:flex;
    flex-direction:column;
    gap:18px;
  }

  /* Top header */
  .topbar {
    display:flex;
    align-items:center;
    gap:12px;
    justify-content:space-between;
  }
  .brand {
    display:flex;align-items:center;gap:12px;
  }
  .logo {
    width:56px;height:56px;border-radius:12px;
    background:linear-gradient(90deg,#e9e3ff 0%, #41296a 100%);
    display:flex;align-items:center;justify-content:center;font-weight:800;color:#261949;
    box-shadow: 0 6px 16px rgba(0,0,0,0.35);
  }
  .brand h1{font-size:1.15rem;letter-spacing:.02em}
  .controls {display:flex;gap:8px;align-items:center;}

  /* Search */
  .search {
    background:var(--glass);padding:8px 12px;border-radius:12px;display:flex;gap:8px;align-items:center;
  }
  .search input{background:transparent;border:none;color:inherit;outline:none;width:240px}

  /* Feed cards */
  .feed { display:flex;flex-direction:column; gap:12px; }
  .card {
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.06));
    border-radius:var(--radius);
    padding:14px;
    box-shadow: 0 6px 24px rgba(0,0,0,0.22);
    border: 1px solid rgba(255,255,255,0.03);
  }
  .card .meta {display:flex;align-items:center;gap:10px;margin-bottom:8px}
  .avatar {
    width:44px;height:44px;border-radius:10px;background:linear-gradient(90deg,#aad1ff,#6a529f);
    display:flex;align-items:center;justify-content:center;font-weight:700;color:#0b1220;
  }
  .meta .who {font-weight:700}
  .meta .time {color:var(--muted);font-size:.88rem}

  .post-title{font-weight:800;margin:6px 0}
  .post-body{color:#dfeaff;opacity:.95;line-height:1.45}

  .post-actions{display:flex;gap:8px;margin-top:10px;color:var(--muted);font-weight:700}

  /* Right column: profile + chat */
  .sidebar {
    display:flex;flex-direction:column;gap:14px;
    position:relative;
  }
  .profile-card{
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.06));
    padding:14px;border-radius:var(--radius);text-align:center;
  }
  .profile-card .big-avatar{
    width:96px;height:96px;margin:auto;border-radius:18px;display:flex;align-items:center;justify-content:center;
    font-size:1.8rem;font-weight:800;color:#0b1220;background:linear-gradient(90deg,#c7dbff,#8c66d6);
    position:relative;
    border:3px solid transparent;
  }

  /* status badge layer */
  .status-badge {
    position:absolute;right:-6px;bottom:-6px;background:#111; color:#fff;padding:6px 8px;border-radius:999px;font-weight:700;
    box-shadow:0 10px 30px rgba(0,0,0,0.5);
    transform:translate(0,0);
  }

  .profile-info{margin-top:10px}
  .profile-info h3{font-size:1.06rem}
  .profile-info p{color:var(--muted);font-size:.95rem;margin-top:6px}

  /* Rank classes (borders + glow) */
  .rank-dev { border-image: linear-gradient(90deg,#6a00ff,#c892ff) 1; border-style: solid; border-width:3px; animation: devGlow 2s infinite alternate; }
  @keyframes devGlow { from { box-shadow: 0 0 8px #6a00ff; } to { box-shadow: 0 0 26px #c892ff; } }

  .rank-admin { border-image: linear-gradient(90deg,#ffd300,#fff599) 1; border-style: solid; border-width:3px; animation: adminGlow 1.8s infinite alternate; }
  @keyframes adminGlow { from { box-shadow: 0 0 8px #ffd300; } to { box-shadow: 0 0 26px #fff599; } }

  .rank-president { border-image: linear-gradient(90deg,#ff0040,#ff7e7e) 1; border-style: solid; border-width:3px; animation: presGlow 2s infinite alternate; }
  @keyframes presGlow { from { box-shadow: 0 0 8px #ff0040; } to { box-shadow: 0 0 26px #ff7e7e; } }

  .rank-vip { border-image: linear-gradient(90deg,#ffd27a,#ffb400) 1; border-style: solid; border-width:3px; animation: vipGlow 1.6s infinite alternate; }
  @keyframes vipGlow { from { box-shadow: 0 0 6px #ffd27a; } to { box-shadow: 0 0 20px #ffb400; } }

  /* status animations (fire/ice/ghost) */
  .status-fire::after {
    content:"";position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;
    box-shadow: 0 0 30px rgba(255,120,50,0.45), inset 0 0 40px rgba(255,80,12,0.15);
    mix-blend-mode:screen;pointer-events:none;
    animation: flicker 1.6s infinite;
  }
  @keyframes flicker { 0%{opacity:.8}50%{opacity:1}100%{opacity:.85} }

  .status-ice::after {
    content:"";position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;
    box-shadow: 0 0 26px rgba(120,230,255,0.36), inset 0 0 30px rgba(160,230,255,0.05);
    animation: icePulse 2.8s infinite;
  }
  @keyframes icePulse { 0%{transform:scale(1)}50%{transform:scale(1.02)}100%{transform:scale(1)} }

  .status-ghost { opacity:.92; filter:blur(.02px); animation: ghostFade 3s infinite; }
  @keyframes ghostFade { 0%{opacity:1}50%{opacity:.6}100%{opacity:1} }

  /* Chat panel */
  .chat-panel {
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.04));
    border-radius:var(--radius);padding:12px;height:360px;display:flex;flex-direction:column;
  }
  .chat-messages { flex:1; overflow:auto; display:flex;flex-direction:column; gap:8px; padding-right:6px; margin-bottom:8px; }
  .msg {max-width:72%; padding:8px 10px;border-radius:12px;line-height:1.3;}
  .msg.me { align-self:flex-end; background:linear-gradient(90deg,#3fa7ff,#2777d9); color:#041022; font-weight:700;}
  .msg.them { align-self:flex-start; background:rgba(255,255,255,0.04); color:#e6f0ff;}
  .chat-input {display:flex; gap:8px; align-items:center;}
  .chat-input input{flex:1;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
  .chat-input button{padding:10px 12px;border-radius:10px;border:none;background:var(--accent);color:#071227;font-weight:800;cursor:pointer}

  /* Magazin modal (reused & improved) */
  .magazin-overlay{ position:fixed; left:0;right:0;top:0;bottom:0;background:rgba(3,2,9,0.65);display:none;align-items:center;justify-content:center; z-index:1000}
  .magazin-overlay.active{display:flex}
  .magazin-modal {
    width:min(420px,92vw); background:linear-gradient(180deg,#0e0d14, #171427); padding:18px;border-radius:16px; color:#e9e3ff; box-shadow:0 20px 60px rgba(0,0,0,0.6);
  }
  .prod-grid{ display:flex;flex-direction:column;gap:12px;margin-top:8px;}
  .prod-item{ display:flex;gap:12px;align-items:center;padding:10px;border-radius:12px;background:rgba(255,255,255,0.02)}
  .prod-item .ico{width:44px;height:44px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-weight:800;color:#071227;background:linear-gradient(90deg,#c7dbff,#8c66d6)}
  .btn {padding:8px 12px;border-radius:10px;border:none;background:var(--accent);color:#071227;font-weight:800;cursor:pointer}

  /* bottom icons bar (mobile-ish) */
  .icons-bar {
    position:fixed;left:12px;right:12px;bottom:12px;z-index:60;display:flex;justify-content:center;
  }
  .icons-bar .bar {
    width:min(980px,calc(100vw - 32px));
    background:rgba(7,10,18,0.6);padding:10px;border-radius:16px;display:flex;gap:8px;align-items:center;justify-content:center;box-shadow:0 12px 30px rgba(0,0,0,0.4);
  }
  .icons-bar .btn { background:transparent;border:1px solid rgba(255,255,255,0.04); color:var(--muted); padding:8px 12px;border-radius:10px; cursor:pointer; font-weight:700; }
  .icons-bar .btn.active{ color:#e9e3ff; background:rgba(255,255,255,0.03); border-color:rgba(255,255,255,0.06) }

  /* responsive */
  @media (max-width:980px){ .app{grid-template-columns:1fr} .sidebar{order:2} .main{order:1} .profile-card{position:sticky;top:12px} }
  .garland {
  position: fixed;
  left: 0; right: 0; top: 0;
  height: 48px;
  z-index: 100;
  display: flex;
  align-items: flex-end;
  justify-content: center;
  gap: 14px;
  pointer-events: none;
  padding: 12px 0;
}

.garland-light {
  width: 18px; height: 18px;
  border-radius: 999px;
  box-shadow: 0 0 18px #fff8, 0 0 8px #fff4;
  animation: garland-blink 2.2s infinite;
  margin-bottom: 4px;
  border: 2px solid #fff3;
}

.garland-light1 { background: #ff5353; animation-delay: 0s;}
.garland-light2 { background: #ffe347; animation-delay: .3s;}
.garland-light3 { background: #3aff79; animation-delay: .6s;}
.garland-light4 { background: #53baff; animation-delay: .9s;}
.garland-light5 { background: #ff99ff; animation-delay: 1.2s;}
.garland-light6 { background: #ffa543; animation-delay: 1.5s;}
@keyframes garland-blink {
  0%,100%{ opacity:.85; }
  40%{ opacity:1; box-shadow:0 0 28px #fffC; }
  60%{ opacity:.7; }
}
#snow {
  position: fixed;
  top: 0; left: 0; width: 100vw; height: 100vh;
  pointer-events: none;
  z-index: 10;
}
/* Gerlyanda chiroqlari */
.garland {
  position: fixed;
  left: 0; right: 0; top: 0;
  height: 48px;
  z-index: 100;
  display: flex;
  align-items: flex-end;
  justify-content: center;
  gap: 14px;
  pointer-events: none;
  padding: 12px 0;
}

.garland-light {
  width: 18px; height: 18px;
  border-radius: 999px;
  box-shadow: 0 0 18px #fff8, 0 0 8px #fff4;
  animation: garland-blink 2.2s infinite;
  margin-bottom: 4px;
  border: 2px solid #fff3;
}

.garland-light1 { background: #ff5353; animation-delay: 0s;}
.garland-light2 { background: #ffe347; animation-delay: .3s;}
.garland-light3 { background: #3aff79; animation-delay: .6s;}
.garland-light4 { background: #53baff; animation-delay: .9s;}
.garland-light5 { background: #ff99ff; animation-delay: 1.2s;}
.garland-light6 { background: #ffa543; animation-delay: 1.5s;}
@keyframes garland-blink {
  0%,100%{ opacity:.85; }
  40%{ opacity:1; box-shadow:0 0 28px #fffC; }
  60%{ opacity:.7; }
}

/* Snow canvas */
#snow {
  position: fixed;
  top: 0; left: 0; width: 100vw; height: 100vh;
  pointer-events: none;
  z-index: 10;
}
</style>
</head>
<body>
  <!-- Gerlyanda chiroqlari -->
<div class="garland"></div>
<canvas id="snow"></canvas>

<!-- Magazin modal -->
<div class="magazin-overlay" id="magazinOverlay" aria-hidden="true">
  <div class="magazin-modal" role="dialog" aria-modal="true">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <h3 style="margin:0">Magazin</h3>
      <button onclick="closeMagazin()" style="background:none;border:none;color:#c7dbff;font-weight:800;font-size:20px;cursor:pointer">&times;</button>
    </div>
    <p style="color:var(--muted);margin-top:6px">Sotib olingan mahsulotlar profilga avtomatik qo ªshiladi. (Demo: bepul - localStorage orqali)</p>
    <div class="prod-grid">
      <div class="prod-item">
        <div class="ico">DEV</div>
        <div style="flex:1">
          <div style="font-weight:800">Dev Rang (moviy/purple)</div>
          <div style="color:var(--muted)">Profilga Dev rang border qo ªshadi</div>
        </div>
        <button class="btn" onclick="buy('dev')">Ol</button>
      </div>
      <div class="prod-item">
        <div class="ico">ADM</div>
        <div style="flex:1">
          <div style="font-weight:800">Admin Rang (sariq)</div>
          <div style="color:var(--muted)">Admin border + status</div>
        </div>
        <button class="btn" onclick="buy('admin')">Ol</button>
      </div>
      <div class="prod-item">
        <div class="ico">PRS</div>
        <div style="flex:1">
          <div style="font-weight:800">President (qizil)</div>
          <div style="color:var(--muted)">Profilga eng yuqori rang</div>
        </div>
        <button class="btn" onclick="buy('president')">Ol</button>
      </div>
      <div class="prod-item">
        <div class="ico">üî•</div>
        <div style="flex:1">
          <div style="font-weight:800">Fire Status</div>
          <div style="color:var(--muted)">Profilga yonuvchi status qo ªshadi</div>
        </div>
        <button class="btn" onclick="buy('fire')">Ol</button>
      </div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:6px">
        <button class="btn" onclick="closeMagazin()">Bekor</button>
      </div>
    </div>
  </div>
</div>

<div class="app">
  <div class="main">
    <div class="topbar card">
      <div class="brand">
        <div class="logo">1</div>
        <div>
          <h1>All of 1</h1>
          <div style="color:var(--muted);font-size:.9rem">Yangiliklar ¬∑ O ªyinlar ¬∑ Chat</div>
        </div>
      </div>

      <div class="controls">
        <div class="search">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M21 21l-4.35-4.35" stroke="#aad1ff" stroke-width="1.6" stroke-linecap="round"/></svg>
          <input placeholder="Qidirish..." id="searchInput" />
        </div>
        <button class="btn" onclick="openMagazin()">Magazin</button>
      </div>
    </div>

    <!-- Feed -->
    <div class="feed" id="feed">
      <!-- sample posts injected by JS -->
    </div>

    <!-- Create post -->
    <div class="card">
      <div style="display:flex;gap:8px;align-items:flex-start">
        <div class="avatar" id="miniAvatar">U</div>
        <div style="flex:1">
          <textarea id="newPost" placeholder="Nimani yangilang?" style="width:100%;min-height:60px;background:transparent;border-radius:8px;border:1px solid rgba(255,255,255,0.03);padding:8px;color:inherit"></textarea>
          <div style="display:flex;gap:8px;margin-top:8px;justify-content:flex-end">
            <button class="btn" onclick="addPost()">Post</button>
            <button class="btn" onclick="clearPosts()" style="background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)">Tozalash</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <aside class="sidebar">
    <div class="profile-card card" id="profileCard">
      <div style="position:relative;">
        <div class="big-avatar" id="bigAvatar">U
          <div class="status-badge" id="statusBadge" style="display:none">STATUS</div>
        </div>
      </div>
      <div class="profile-info">
        <h3 id="profileName">NoName</h3>
        <p id="profileDesc">Profilingiz: unga rang va status qo ªshing ‚Äî Magazin orqali.</p>
      </div>
      <div style="display:flex;gap:8px;justify-content:center;margin-top:12px">
        <button class="btn" onclick="openMagazin()">Magazin</button>
        <button class="btn" onclick="promptNick()">Nick</button>
      </div>
    </div>

    <div class="chat-panel card">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
        <strong>Chat ‚Äî demo</strong>
        <small style="color:var(--muted)">Offline demo</small>
      </div>
      <div class="chat-messages" id="chatMessages" role="log" aria-live="polite">
        <!-- messages -->
      </div>

      <div class="chat-input">
        <input id="chatInput" placeholder="Xabar yozing..." />
        <button onclick="sendMsg()">Yuborish</button>
      </div>
    </div>

  </aside>
</div>

<!-- bottom icons -->
<div class="icons-bar">
  <div class="bar">
    <button class="btn active" onclick="showTab('feed')">Global</button>
    <button class="btn" onclick="showTab('messages')">Messages</button>
    <button class="btn" onclick="showTab('friends')">Friends</button>
    <button class="btn" onclick="openMagazin()">Magazin</button>
    <button class="btn" onclick="showTab('settings')">Settings</button>
  </div>
</div>

<script>
/* ---------- Demo data & helpers ---------- */

const samplePosts = [
  {id:1, who:'GameNews', title:'CyberQuest 2 - yangilanish', body:'Bugun yangi patch chiqdi ‚Äî yangi xaritalar va weapon balancing. Patch notes: Qo ªshimcha map: Neon Labs.'},
  {id:2, who:'TechWorld', title:'Yangi telefon chiqdi', body:'Yangi Pixel like device 16GB RAM bilan. Benchmarks juda yaxshi.'},
  {id:3, who:'AllOf1', title:'Welcome', body:'All of 1 saytiga xush kelibsiz! Forum va chat hozir demo rejimida ishlaydi.'}
];

const feedEl = document.getElementById('feed');
const chatMessages = document.getElementById('chatMessages');

function renderFeed(list = samplePosts){
  feedEl.innerHTML = '';
  for(const p of list){
    const card = document.createElement('div');
    card.className = 'card';
    card.innerHTML = `
      <div class="meta">
        <div class="avatar">${p.who.charAt(0)}</div>
        <div>
          <div class="who">${p.who}</div>
          <div class="time">just now</div>
        </div>
      </div>
      <div class="post-title">${p.title}</div>
      <div class="post-body">${p.body}</div>
      <div class="post-actions">
        <div style="cursor:pointer" onclick="like(${p.id}, this)">üëç Like</div>
        <div style="cursor:pointer" onclick="share(${p.id})">üîÅ Share</div>
        <div style="cursor:pointer" onclick="comment(${p.id})">üí¨ Comment</div>
      </div>
    `;
    feedEl.appendChild(card);
  }
}
renderFeed();

/* Post creation */
function addPost(){
  const txt = document.getElementById('newPost').value.trim();
  if(!txt) return alert('Post yozing...');
  const newP = { id: Date.now(), who: localStorage.getItem('nickname') || 'Siz', title:'User post', body: txt };
  samplePosts.unshift(newP);
  document.getElementById('newPost').value = '';
  renderFeed();
}

/* Simulated actions */
function like(id, el){ el.textContent = 'üíô Liked'; setTimeout(()=>el.textContent='üëç Like',1400); }
function share(id){ alert('Share demo: id ' + id); }
function comment(id){ const c = prompt('Kommentar yozing:'); if(c) alert('Comment yuborildi: ' + c); }

/* Chat demo */
function sendMsg(){
  const txt = document.getElementById('chatInput').value.trim();
  if(!txt) return;
  appendMsg(txt,'me');
  document.getElementById('chatInput').value = '';
  // demo bot reply
  setTimeout(()=>appendMsg('Server: demo javob ‚Äî ' + txt, 'them'), 900);
}
function appendMsg(text, who){
  const d = document.createElement('div');
  d.className = 'msg ' + (who==='me' ? 'me' : 'them');
  d.textContent = text;
  chatMessages.appendChild(d);
  chatMessages.scrollTop = chatMessages.scrollHeight;
}
/* add some demo messages */
appendMsg('Xush kelibsiz All of 1 chat demo.','them');

/* Profile & Magazin functions */
function promptNick(){
  const n = prompt('Yangi nickname kiriting: (misol: YusufDev)');
  if(n){
    localStorage.setItem('nickname', n);
    applyProfile();
    showStatus('Nick saqlandi: ' + n);
  }
}
function applyProfile(){
  const nick = localStorage.getItem('nickname') || 'NoName';
  document.getElementById('profileName').textContent = nick;
  document.getElementById('miniAvatar').textContent = nick.charAt(0).toUpperCase();
  document.getElementById('bigAvatar').textContent = nick.charAt(0).toUpperCase();
  // apply rank class if any
  const rank = localStorage.getItem('rank'); // values: dev, admin, president, vip
  const big = document.getElementById('bigAvatar');
  big.classList.remove('rank-dev','rank-admin','rank-president','rank-vip','status-fire','status-ice','status-ghost');
  document.getElementById('statusBadge').style.display='none';
  if(rank==='dev'){ big.classList.add('rank-dev'); }
  if(rank==='admin'){ big.classList.add('rank-admin'); }
  if(rank==='president'){ big.classList.add('rank-president'); }
  if(rank==='vip'){ big.classList.add('rank-vip'); }

  // status
  const status = localStorage.getItem('status'); // fire, ice, ghost
  if(status==='fire'){ big.classList.add('status-fire'); document.getElementById('statusBadge').style.display='block'; document.getElementById('statusBadge').textContent='FIRE' }
  if(status==='ice'){ big.classList.add('status-ice'); document.getElementById('statusBadge').style.display='block'; document.getElementById('statusBadge').textContent='ICE' }
  if(status==='ghost'){ big.classList.add('status-ghost'); document.getElementById('statusBadge').style.display='block'; document.getElementById('statusBadge').textContent='GHOST' }

  // small desc update
  const desc = localStorage.getItem('desc') || 'Profilingiz: unga rang va status qo ªshing ‚Äî Magazin orqali.';
  document.getElementById('profileDesc').textContent = desc;
}
applyProfile();

function openMagazin(){ document.getElementById('magazinOverlay').classList.add('active'); }
function closeMagazin(){ document.getElementById('magazinOverlay').classList.remove('active'); }

function buy(key){
  // demo: save to localStorage
  if(key==='dev'){ localStorage.setItem('rank','dev'); showStatus('Dev rank qo ªshildi!') }
  if(key==='admin'){ localStorage.setItem('rank','admin'); showStatus('Admin rank qo ªshildi!') }
  if(key==='president'){ localStorage.setItem('rank','president'); showStatus('President rank qo ªshildi!') }
  if(key==='fire'){ localStorage.setItem('status','fire'); showStatus('Fire status qo ªshildi!') }
  // reflect immediately
  applyProfile();
  // close modal a bit later
  setTimeout(()=>closeMagazin(),400);
}

/* status bar / toasts */
function showStatus(txt){
  // small floating toast on top of page
  let el = document.getElementById('__toast__');
  if(!el){
    el = document.createElement('div');
    el.id='__toast__';
    el.style.position='fixed';
    el.style.top='18px';
    el.style.left='50%';
    el.style.transform='translateX(-50%)';
    el.style.background='rgba(14,14,25,0.8)';
    el.style.color='#c7dbff';
    el.style.padding='10px 14px';
    el.style.borderRadius='10px';
    el.style.zIndex=9999;
    el.style.boxShadow='0 12px 40px rgba(0,0,0,0.6)';
    document.body.appendChild(el);
  }
  el.textContent = txt;
  el.style.opacity = '1';
  clearTimeout(window.__toast_timeout);
  window.__toast_timeout = setTimeout(()=>{ el.style.opacity='0'; }, 2600);
}

/* small utilities */
function clearPosts(){
  if(!confirm('Haqiqatan ham posts tozalansinmi? (faqat demo)')) return;
  samplePosts.length = 0;
  renderFeed();
  showStatus('Feed tozalandi (demo).');
}

/* bottom bar tabs (demo) */
function showTab(name){
  const buttons = document.querySelectorAll('.icons-bar .btn');
  buttons.forEach(b => b.classList.remove('active'));
  // mark clicked
  Array.from(buttons).find(b => b.textContent.trim().toLowerCase().includes(name))?.classList.add('active');
  // simple behavior
  if(name==='messages'){ document.querySelector('.chat-panel').scrollIntoView({behavior:'smooth'}); showStatus('Messages ga o‚Äòtildi'); }
  if(name==='feed'){ window.scrollTo({top:0,behavior:'smooth'}); showStatus('Global feed'); }
}

/* search filter */
document.getElementById('searchInput').addEventListener('input', (e)=>{
  const q = e.target.value.trim().toLowerCase();
  if(!q) return renderFeed();
  const filtered = samplePosts.filter(p => (p.title + ' ' + p.body + ' ' + p.who).toLowerCase().includes(q));
  renderFeed(filtered);
});

/* load nickname if exists */
document.addEventListener('DOMContentLoaded', ()=>{
  const nick = localStorage.getItem('nickname');
  if(!nick){
    // auto prompt? skip to avoid annoying - user can click Nick button
    // promptNick();
  } else {
    applyProfile();
    showStatus('Sizning nick: ' + nick);
  }
});
function applyProfile(){
  const nick = localStorage.getItem('nickname') || 'NoName';
  document.getElementById('profileName').textContent = nick;

  const first = nick.charAt(0).toUpperCase();
  document.getElementById('miniAvatar').textContent = first;
  document.getElementById('bigAvatar').textContent = first;

  // rank va statuslarni yuklash
  const rank = localStorage.getItem('rank') || '';
  const status = localStorage.getItem('status') || '';

  const big = document.getElementById('bigAvatar');
  const card = document.getElementById('profileCard');
  const badge = document.getElementById('statusBadge');

  // tozalash
  big.classList.remove('status-fire', 'status-ice', 'status-ghost');
  card.classList.remove('rank-dev', 'rank-admin', 'rank-president', 'rank-vip');
  badge.style.display = 'none';

  // rang qo‚Äòllash
  if(rank === 'dev') card.classList.add('rank-dev');
  if(rank === 'admin') card.classList.add('rank-admin');
  if(rank === 'president') card.classList.add('rank-president');
  if(rank === 'vip') card.classList.add('rank-vip');

  // status qo‚Äòllash
  if(status){
    badge.style.display = 'block';
    if(status === 'fire'){
      big.classList.add('status-fire');
      badge.textContent = "üî• Fire";
    }
    if(status === 'ice'){
      big.classList.add('status-ice');
      badge.textContent = "‚ùÑ Ice";
    }
    if(status === 'ghost'){
      big.classList.add('status-ghost');
      badge.textContent = "üëª Ghost";
    }
  }
}

/* MAGAZINDAN SOTIB OLISH */
function buy(type){
  if(type === 'dev'){
    localStorage.setItem('rank','dev');
    alert('Dev rang olindi!');
  }
  if(type === 'admin'){
    localStorage.setItem('rank','admin');
    alert('Admin rang olindi!');
  }
  if(type === 'president'){
    localStorage.setItem('rank','president');
    alert('President olindi!');
  }
  if(type === 'fire'){
    localStorage.setItem('status','fire');
    alert('Fire status qo‚Äòshildi!');
  }
  
  applyProfile();
  closeMagazin();
}

/* Yordamchi */
function showStatus(t){ console.log(t); }

/* dastlabki yuklash */
applyProfile();
// Gerlyanda chiroqlari soni
const garland = document.querySelector('.garland');
for(let i=1; i<=10; i++){
  const d = document.createElement('div');
  d.className = `garland-light garland-light${(i%6)+1}`;
  garland.appendChild(d);
}
// Qor effecti uchun
const snowCanvas = document.getElementById('snow');
const ctx = snowCanvas.getContext('2d');
let W = window.innerWidth, H = window.innerHeight;
snowCanvas.width = W; snowCanvas.height = H;

const snowflakes = [];
for(let i=0;i<70;i++){
  snowflakes.push({
    x:Math.random()*W,
    y:Math.random()*H,
    r: 1.5+Math.random()*3,
    d:Math.random()*70
  });
}

function drawSnow(){
  ctx.clearRect(0,0,W,H);
  ctx.fillStyle='rgba(255,255,255,0.8)';
  ctx.beginPath();
  for(const s of snowflakes){
    ctx.moveTo(s.x, s.y);
    ctx.arc(s.x, s.y, s.r, 0, Math.PI*2, true);
  }
  ctx.fill();
  updateSnow();
}

let angle=0;
function updateSnow(){
  angle += 0.01;
  for(let i=0;i<snowflakes.length;i++){
    const s=snowflakes[i];
    s.y += Math.cos(angle+s.d)+1+s.r/2;
    s.x += Math.sin(angle)*2;
    if(s.x > W+5 || s.x < -5 || s.y > H){
      s.x = Math.random()*W;
      s.y = -10;
    }
  }
}

setInterval(drawSnow,30);
window.addEventListener('resize', ()=>{
  W=window.innerWidth;H=window.innerHeight;
  snowCanvas.width=W;snowCanvas.height=H;
});
</script>

</body>
</html>
